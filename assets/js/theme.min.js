function search(e){let t=new URL(location.href).searchParams.get("q");new URL(location.href).searchParams.get("lang")||ui.lang;$("input[name='q']").val(t);let a=[],n=new RegExp;try{n=new RegExp(t,"im")}catch(e){return $(".search-results .content").empty(),$(".search-results .summary").html(ui.i18n.search_results_not_found),$(".search-results h2").html(ui.i18n.search_results),debug(e.message)}function s(e,t,a){return e.slice(t,a).replace(n,(e=>`<span class="bg-yellow">${e}</span>`))}for(page of e){let[e,l]=[null,null];try{page.title?e=page.title.match(n):"/"==page.url?page.title=ui.title:page.title=page.url}catch(e){debug(e.message)}try{page.content&&(page.content=$("<div/>").html(page.content).text(),l=page.content.match(n))}catch(e){debug(e.message)}if(e||l){let e=[`<a href="${ui.baseurl}${page.url}?highlight=${t}">${page.title}</a>`];if(l){let[t,a]=[l.index-100,l.index+100],[n,i]=["...","..."];t<0&&(n="",t=0),a>page.content.length&&(i="",a=page.content.length),e.push(`<p class="text-gray">${n}${s(page.content,t,a)}${i}</p>`)}a.push(`<li class="border-top py-4">${e.join("")}</li>`)}}a.length>0&&t.length>0?($(".search-results .content").html(a.join("")),$(".search-results .summary").html(ui.i18n.search_results_found.replace("#",a.length))):($(".search-results .content").empty(),$(".search-results .summary").html(ui.i18n.search_results_not_found)),$(".search-results h2").html(ui.i18n.search_results)}function initialize(e){let t=$(".toctree").find(`[href="${decodeURI(e)}"]`);if(t.length>0){$(".toctree .current").removeClass("current"),t.addClass("current"),t.closest(".level-1").parent().addClass("current");for(let e=1;e<=11;e++)t.closest(`.level-${e}`).addClass("current")}}function toggleCurrent(e){let t=e.closest("li");t.siblings("li.current").removeClass("current"),t.siblings().find("li.current").removeClass("current"),t.find("> ul li.current").removeClass("current"),t.toggleClass("current")}function toc(){$(".toctree li.current").append('<ul class="content-toc"></ul>').html((function(){let e=parseInt(this.dataset.level),t=0,a=[$(this).find(".content-toc")];$(".markdown-body").find("h2,h3,h4,h5,h6").each((function(){let n=$("<a/>").addClass("d-flex flex-items-baseline").text($(this).text()).attr("href",`#${this.id}`),s=parseInt(this.tagName.slice(1))-1;if(s>t){let e=a[0].children("li:last")[0];e&&a.unshift($("<ul/>").appendTo(e))}else a.splice(0,Math.min(t-s,Math.max(a.length-1,0)));t=s,$("<li/>").addClass(`toc level-${e+s}`).append(n).appendTo(a[0])})),a[0].html()||a[0].remove()}))}function set(e,t){return localStorage.setItem(e,t)}function get(e){return localStorage.getItem(e)||!1}function debug(){console.debug.apply(console,arguments)}function restore(){let e=get("scroll"),t=get("scrollTime"),a=get("scrollHost");e&&t&&a&&a==location.host&&Date.now()-t<6e5&&$(".sidebar").scrollTop(e),$(".sidebar").scroll((function(){set("scroll",this.scrollTop),set("scrollTime",Date.now()),set("scrollHost",location.host)}))}function highlight(){let e=new URL(location.href).searchParams.get("highlight"),t="([\\[\\]\\(\\)]*(<em>){0,1}"+e+"[\\[\\]\\(\\)]*(</em>){0,1})";t=t.replace(/-/g,"(</em>){0,1}[ \\[\\]\\(\\).]+(<em>){0,1}"),e&&($(".markdown-body").find("*").each((function(){try{this.outerHTML.match(new RegExp(t,"im"))&&($(this).addClass("search-result"),$(this).parentsUntil(".markdown-body").removeClass("search-result"))}catch(e){debug(e.message)}})),$(".search-result").each((function(){$(this).html((function(e,a){return a.replace(new RegExp(t,"im"),'<span class="bg-yellow">$1</span>')}))})),$(".search input").val(e))}$(window).bind("hashchange",(()=>initialize(location.hash||location.pathname))),$(document).on("scroll",(function(){let e=$(this).scrollTop()+5,t=[];$(".markdown-body").find("h1,h2,h3,h4,h5,h6").each((function(){t.push({offset:$(this).offset().top,id:this.id,level:parseInt(this.tagName.slice(1))})}));for(let a=0;a<t.length;a++)e>t[a].offset&&(a<t.length-1?e<t[a+1].offset&&(1==t[a].level?initialize(location.pathname):initialize("#"+t[a].id)):initialize("#"+t[a].id))})),$("#toggle").click((function(){$(".sidebar-wrap,.content-wrap,.addons-wrap").toggleClass("shift")})),$(".status").click((function(){$(".addons").toggleClass("d-none")})),location.pathname==`${ui.baseurl}/search.html`&&$.ajax(`${ui.baseurl}/data.json`).done(search).fail(((e,t)=>debug(t))),toc(),initialize(location.pathname),initialize(location.hash),restore(),highlight(),$(".toc ul").siblings("a").each((function(){let e=$(this),t=$('<i class="fa fa-plus-square-o"></i>');t.on("click",(function(t){return t.stopPropagation(),toggleCurrent(e),!1})),e.prepend(t)})),$(".markdown-body :header").append((function(){return`<a href="#${this.id}" class="anchor"><i class="octicon-link fa fa-link text-blue"></i></a>`})),$("div.highlighter-rouge").each((function(){const e=$(this).attr("class").match(/language-(\w+)/);e&&$(this).attr("data-lang",e[1])})),"serviceWorker"in navigator?navigator.serviceWorker.register(`${ui.baseurl}/sw.caches.js`):debug("Service Worker not supported!");
